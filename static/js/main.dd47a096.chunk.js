(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{109:function(e,t,n){"use strict";n.r(t);var r=n(2),a=n(0),c=n.n(a),s=n(15),i=n.n(s),o=(n(78),n(48)),l=(n(79),n(20)),u=n(21),d=n(24),h=n(23),j=n(133),b=n(124),p=n(125),m=n(111),f=n(22),O=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){return Object(r.jsxs)("div",{children:[Object(r.jsx)(j.a,{position:"static",children:Object(r.jsxs)(b.a,{children:[Object(r.jsx)(p.a,{variant:"h5",children:Object(r.jsxs)("a",{component:c.a.Fragment,href:"./",className:"link-unstyled",children:[Object(r.jsx)("i",{style:{color:"#69f0ae"},className:"fa fa-lg fa-cutlery"}),"\xa0\xa0 Food Shop"]})}),Object(r.jsx)("span",{style:{flex:.02}})]})}),Object(r.jsx)("br",{}),Object(r.jsxs)("div",{style:{textAlign:"center"},children:[null===this.props.user?Object(r.jsx)(m.a,{component:f.b,to:"/login",variant:"contained",children:"Login/Signup"}):Object(r.jsxs)(m.a,{component:f.b,to:"/login",onClick:this.props.logOut,variant:"contained",children:["Logout (",this.props.user.username,")"]}),"\xa0\xa0",Object(r.jsx)(m.a,{component:f.b,to:"/shop",variant:"contained",children:"Shop"}),"\xa0\xa0",Object(r.jsx)(m.a,{component:f.b,to:"/cart",variant:"contained",children:"Cart"})]})]})}}]),n}(a.Component),x=n(28),g=n(64),v=n(10),y=n(126),I=n(127),k=n(130),C=n(8),U=n(33),w=n.n(U),S=n(47),N=n.n(S),L="https://web-cart-api.herokuapp.com",F={apiUrl:L,getItems:function(){return w.a.get("".concat(L,"/items")).then((function(e){return e.data?e.data:null}))},getUser:function(e,t){return w.a.get("".concat(L,"/users")).then((function(e){return e.data})).then((function(t){return t.filter((function(t){return t.username===e}))})).then((function(e){return e.length>0?e[0]:null})).then((function(e){return null===e||e.password===N()(t)?e:-1}))},updateUser:function(e,t){return w.a.put("".concat(L,"/users/").concat(e),t)},findUser:function(e,t){return w.a.get("".concat(L,"/users")).then((function(e){return e.data})).then((function(t){return t.filter((function(t){return t.username===e}))})).then((function(e){return e.length>0?e[0]:null}))},registerUser:function(e,t){return w.a.post("".concat(L,"/users"),{username:e,password:N()(t),cart:[]}).then((function(e){return e.data}))}},P=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(l.a)(this,n),(r=t.call(this,e)).loadItems=r.loadItems.bind(Object(v.a)(r)),r.countItem=r.countItem.bind(Object(v.a)(r)),r.incrementItem=r.incrementItem.bind(Object(v.a)(r)),r.decrementItem=r.decrementItem.bind(Object(v.a)(r)),r.state={items:[]},r.loadItems(),r}return Object(u.a)(n,[{key:"loadItems",value:function(){var e=this;F.getItems().then((function(t){e.setState({items:t})}))}},{key:"countItem",value:function(e){var t,n=Object(g.a)(this.props.user.cart);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r[0]===e)return r[1]}}catch(a){n.e(a)}finally{n.f()}return 0}},{key:"incrementItem",value:function(e){for(var t=this,n=Object(x.a)({},this.props.user),r=0;r<n.cart.length;r++)if(n.cart[r][0]===e)return n.cart[r][1]++,void F.updateUser(n.id,n).then((function(e){return t.props.setUser(e.data)}));n.cart.push([e,1]),F.updateUser(n.id,n).then((function(e){return t.props.setUser(e.data)}))}},{key:"decrementItem",value:function(e){for(var t=this,n=Object(x.a)({},this.props.user),r=0;r<n.cart.length;r++)if(n.cart[r][0]===e)return n.cart[r][1]<=1?n.cart.splice(r,1):n.cart[r][1]--,void F.updateUser(n.id,n).then((function(e){return t.props.setUser(e.data)}))}},{key:"render",value:function(){var e=this;if(null===this.props.user)return Object(r.jsx)(C.a,{to:"/login"});var t=this.state.items.map((function(t,n){return Object(r.jsxs)("div",{className:"col-12 col-md-4 mb-3 text-center text-md-left",children:[Object(r.jsx)("img",{style:{height:130,width:130,borderRadius:50,border:"1px solid black"},src:"".concat(F.apiUrl,"/static/").concat(t.img),alt:t.name}),Object(r.jsx)(p.a,{variant:"h4",children:t.name}),Object(r.jsxs)(p.a,{variant:"h6",children:["\u20b9",t.price.toFixed(2)]}),Object(r.jsxs)("div",{children:["In cart: ",e.countItem(t.id)]}),Object(r.jsxs)(y.a,{variant:"contained",children:[Object(r.jsx)(m.a,{onClick:function(){return e.incrementItem(t.id)},children:"+"}),Object(r.jsx)(m.a,{onClick:function(){return e.decrementItem(t.id)},children:"-"})]})]},n)}));return Object(r.jsxs)(I.a,{maxWidth:"md",style:{padding:7,paddingBottom:60},children:[Object(r.jsx)("h1",{className:"text-center text-md-left mb-4",children:"Shop"}),Object(r.jsx)(k.a,{className:"container-fluid",children:Object(r.jsx)("div",{className:"row",children:t})})]})}}]),n}(a.Component),W=n(40),B=n(128),J=n(134),A=n(131),E=n(29),q=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(l.a)(this,n),(r=t.call(this,e)).handleLogin=r.handleLogin.bind(Object(v.a)(r)),r.handleSignup=r.handleSignup.bind(Object(v.a)(r)),r.verifyInput=r.verifyInput.bind(Object(v.a)(r)),r.handleChange=r.handleChange.bind(Object(v.a)(r)),r.state={user:"",pass:""},r}return Object(u.a)(n,[{key:"handleChange",value:function(e){this.setState(Object(W.a)({},e.target.name,e.target.value))}},{key:"verifyInput",value:function(){return this.state.user.length<1?(E.b.error("Enter the username.",{autoClose:2e3}),!1):!(this.state.pass.length<1)||(E.b.error("Enter the password.",{autoClose:2e3}),!1)}},{key:"handleLogin",value:function(){var e=this;this.verifyInput()&&F.getUser(this.state.user.toLowerCase(),this.state.pass).then((function(t){null===t?E.b.error("User doesn't exist.",{autoClose:2e3}):-1===t?E.b.error("Wrong password.",{autoClose:2e3}):e.props.logIn(t)}))}},{key:"handleSignup",value:function(){var e=this;this.verifyInput()&&F.findUser(this.state.user.toLowerCase()).then((function(t){null===t?F.registerUser(e.state.user.toLowerCase(),e.state.pass).then((function(t){return e.props.logIn(t)})):E.b.error("User already exists.",{autoClose:2e3})}))}},{key:"render",value:function(){return null!==this.props.user?Object(r.jsx)(C.a,{to:"/shop"}):Object(r.jsxs)(I.a,{maxWidth:"xs",style:{padding:30},children:[Object(r.jsx)(E.a,{}),Object(r.jsxs)(k.a,{children:[Object(r.jsx)("h1",{children:"Login/Signup"}),Object(r.jsx)("form",{onSubmit:function(e){return e.preventDefault()},children:Object(r.jsxs)(B.a,{children:[Object(r.jsx)(J.a,{children:Object(r.jsx)(A.a,{fullWidth:!0,type:"text",name:"user",required:!0,placeholder:"Username",onChange:this.handleChange,value:this.state.user})}),Object(r.jsx)(J.a,{children:Object(r.jsx)(A.a,{fullWidth:!0,type:"password",name:"pass",required:!0,placeholder:"Password",onChange:this.handleChange,value:this.state.pass})}),Object(r.jsxs)(J.a,{children:[Object(r.jsxs)(m.a,{color:"primary",variant:"contained",onClick:this.handleLogin,children:[Object(r.jsx)("i",{className:"fa fa-sm fa-unlock"}),"\xa0\xa0Login"]}),Object(r.jsx)("span",{style:{flex:1}}),Object(r.jsxs)(m.a,{color:"primary",variant:"contained",onClick:this.handleSignup,children:[Object(r.jsx)("i",{className:"fa fa-sm fa-gear"}),"\xa0\xa0Signup"]})]})]})})]})]})}}]),n}(a.Component),D=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(l.a)(this,n),(r=t.call(this,e)).removeItem=r.removeItem.bind(Object(v.a)(r)),r.loadItems=r.loadItems.bind(Object(v.a)(r)),r.getItem=r.getItem.bind(Object(v.a)(r)),r.netPrice=r.netPrice.bind(Object(v.a)(r)),r.checkout=r.checkout.bind(Object(v.a)(r)),r.state={items:[]},r.loadItems(),r}return Object(u.a)(n,[{key:"loadItems",value:function(){var e=this;F.getItems().then((function(t){e.setState({items:t})}))}},{key:"getItem",value:function(e){var t=this.state.items.filter((function(t){return t.id===e}));return t.length>0?t[0]:null}},{key:"removeItem",value:function(e){for(var t=this,n=Object(x.a)({},this.props.user),r=0;r<n.cart.length;r++)if(n.cart[r][0]===e)return n.cart.splice(r,1),void F.updateUser(n.id,n).then((function(e){return t.props.setUser(e.data)}))}},{key:"netPrice",value:function(){for(var e=0,t=0;t<this.props.user.cart.length;t++){var n=this.getItem(this.props.user.cart[t][0]);n&&n.price&&(e+=n.price*this.props.user.cart[t][1])}return e}},{key:"checkout",value:function(){var e=this,t=Object(x.a)(Object(x.a)({},this.props.user),{},{cart:[]});F.updateUser(t.id,t).then((function(t){return e.props.setUser(t.data)}))}},{key:"render",value:function(){var e,t=this;return null===this.props.user?Object(r.jsx)(C.a,{to:"/login"}):(e=this.props.user.cart.length>0?this.props.user.cart.map((function(e,n){var a=t.getItem(e[0]);return null===a?Object(r.jsx)("span",{},n):(a.count=e[1],Object(r.jsxs)("div",{className:"col-12 col-md-4 mb-3 text-center text-md-left",children:[Object(r.jsx)("img",{style:{height:130,width:130,borderRadius:50,border:"1px solid black"},src:"".concat(F.apiUrl,"/static/").concat(a.img),alt:a.name}),Object(r.jsx)(p.a,{variant:"h4",children:a.name}),Object(r.jsxs)(p.a,{variant:"h6",children:["\u20b9",a.price&&a.count?(a.count*a.price).toFixed(2):""]}),Object(r.jsxs)("div",{className:"pb-2",children:["Count: ",a.count,Object(r.jsx)("br",{}),"Per piece: \u20b9",a.price.toFixed(2)]}),Object(r.jsx)(m.a,{variant:"contained",color:"secondary",onClick:function(){return t.removeItem(a.id)},children:"-"})]},n))})):Object(r.jsx)("h4",{children:"No items in cart."}),Object(r.jsxs)(I.a,{maxWidth:"md",style:{padding:7,paddingBottom:80},children:[Object(r.jsx)("h1",{className:"text-center text-md-left mb-4",children:"Cart"}),Object(r.jsx)(k.a,{className:"container-fluid",children:Object(r.jsxs)("div",{className:"row",children:[e,Object(r.jsx)("div",{className:"col-12",children:e instanceof Array?Object(r.jsx)("div",{className:"container-fluid pt-4",children:Object(r.jsx)("div",{className:"row",children:Object(r.jsxs)("div",{className:"col-12 col-md-9 offset-md-3 text-right",children:[Object(r.jsxs)("h4",{children:["Amount: \u20b9",this.netPrice().toFixed(2)]}),this.netPrice()>0?Object(r.jsx)(m.a,{variant:"contained",size:"large",color:"secondary",onClick:this.checkout,children:"Checkout"}):""]})})}):""})]})})]}))}}]),n}(a.Component),M=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){return Object(r.jsx)("div",{style:{position:"fixed",bottom:"0",width:"100%",marginBottom:0,padding:0},children:Object(r.jsx)(j.a,{position:"static",className:"align-items-center",children:Object(r.jsx)(b.a,{children:Object(r.jsxs)("h4",{children:["Made with ",Object(r.jsx)("i",{id:"footerHeart",class:"fa fa-heart"})," by"," ",Object(r.jsx)("a",{style:{color:"lightblue"},href:"http://www.paramsid.com",target:"_blank",children:"Param"})]})})})})}}]),n}(a.Component);var R=function(){var e=function(e,t){var n=Object(a.useState)((function(){try{var n=window.localStorage.getItem(e);return n?JSON.parse(n):t}catch(r){return console.log(r),t}})),r=Object(o.a)(n,2),c=r[0],s=r[1];return[c,function(t){try{var n=t instanceof Function?t(c):t;s(n),window.localStorage.setItem(e,JSON.stringify(n))}catch(r){console.log(r)}}]}("foodShopUser",null),t=Object(o.a)(e,2),n=t[0],c=t[1];return Object(r.jsx)(r.Fragment,{children:Object(r.jsxs)(f.a,{basename:"/",children:[Object(r.jsx)(O,{user:n,setUser:c,logOut:function(){return c(null)}}),Object(r.jsx)(C.b,{exact:!0,path:"/",children:Object(r.jsx)(C.a,{to:"/login"})}),Object(r.jsx)(C.b,{path:"/login",children:Object(r.jsx)(q,{logIn:c,user:n})}),Object(r.jsx)(C.b,{exact:!0,path:"/shop",children:Object(r.jsx)(P,{setUser:c,user:n})}),Object(r.jsx)(C.b,{exact:!0,path:"/cart",children:Object(r.jsx)(D,{setUser:c,user:n})}),Object(r.jsx)(M,{})]})})};var T=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,136)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,s=t.getTTFB;n(e),r(e),a(e),c(e),s(e)}))};n(104),n(105),n(106),n(59),n(107),n(108);i.a.render(Object(r.jsx)(c.a.StrictMode,{children:Object(r.jsx)(R,{})}),document.getElementById("root")),T()},78:function(e,t,n){},79:function(e,t,n){}},[[109,1,2]]]);
//# sourceMappingURL=main.dd47a096.chunk.js.map